<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>房间分配系统3.6</title>
    <!-- 引入 Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- 引入 React 和 Babel -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-5px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in {
            animation: fadeIn 0.3s ease-out;
        }
        body { font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif; }
        
        /* 隐藏移动端默认滚动条，体验更好 */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        /* 针对电脑端网格的优化 */
        .desktop-grid-card {
            display: flex;
            flex-direction: column;
            height: 100%;
        }
        
        .scrollbar-thin::-webkit-scrollbar {
            width: 6px;
        }
        .scrollbar-thin::-webkit-scrollbar-track {
            background: #f1f5f9; 
        }
        .scrollbar-thin::-webkit-scrollbar-thumb {
            background: #cbd5e1; 
            border-radius: 3px;
        }
        .scrollbar-thin::-webkit-scrollbar-thumb:hover {
            background: #94a3b8; 
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-800 overflow-hidden"> <!-- Body overflow hidden, scroll inside app -->
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo, useCallback } = React;

        // --- 1. 图标组件 ---
        const IconBed = ({ size = 18, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M2 4v16"/><path d="M2 8h18a2 2 0 0 1 2 2v10"/><path d="M2 17h20"/><path d="M6 8v9"/></svg>
        );
        const IconUser = ({ size = 18, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
        );
        const IconUsers = ({ size = 18, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>
        );
        const IconCheck = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>
        );
        const IconHome = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>
        );
        const IconTrash = ({ size = 14, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/><line x1="10" y1="11" x2="10" y2="17"/><line x1="14" y1="11" x2="14" y2="17"/></svg>
        );
        const IconLogin = ({ size = 20, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4"/><polyline points="10 17 15 12 10 7"/><line x1="15" y1="12" x2="3" y2="12"/></svg>
        );
        const IconSearch = ({ size = 18, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>
        );
        // 新增：放大和缩小图标
        const IconMinus = ({ size = 14, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><line x1="5" y1="12" x2="19" y2="12"></line></svg>
        );
        const IconPlus = ({ size = 14, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
        );

        // --- 2. 配置区域 ---
        const INITIAL_CONFIG = [
            { id: 'small_single_1.2', name: '小单间 1.2米', desc: '经济实惠', rooms: [510, 517, 519, 417, 419, 303, 310, 317, 203, 210, 217, 218, 219] },
            { id: 'narrow_double_1.5', name: '窄大床 1.5米', desc: '适合一人住', rooms: [503, 511, 518, 403, 411, 418, 309, 311, 318, 202, 209] },
            { id: 'std_double_1.5', name: '标准大床 1.5米', desc: '标准房型', rooms: [502, 506, 509, 512, 520, 521, 522, 402, 409, 410, 412, 420, 421, 422, 302, 308, 319, 320, 321, 322, 208, 213, 220, 221, 222, 223, 225] },
            { id: 'large_double_1.8', name: '豪华大床 1.8米', desc: '宽敞舒适', rooms: [505, 507, 508, 513, 405, 407, 408, 413, 423, 305, 307, 313, 323, 205, 207, 211] },
            { id: 'twin_1.2', name: '双床房 1.2米', desc: '双人出行', rooms: [501, 515, 516, 401, 415, 416, 301, 316, 201, 216] },
            { id: 'triple_1.0', name: '三床房 1米', desc: '家庭/多人', rooms: [406, 306, 315, 206, 215] }
        ];

        // --- 3. 独立组件定义 ---

        // 3.1 房间卡片组件
        const RoomCard = React.memo(({ room, onToggle, compact = false }) => {
            const isOccupied = room.isOccupied;
            return (
                <button
                    onClick={onToggle}
                    title={isOccupied ? `已入住: ${room.checkInTime}` : "点击办理入住"}
                    className={`
                        relative rounded-lg border-2 text-center transition-all duration-200 flex flex-col items-center justify-center w-full
                        ${compact ? 'h-12 p-1' : 'h-16 p-2'}
                        ${isOccupied 
                        ? 'bg-red-50 border-red-500 text-red-700 shadow-sm' 
                        : 'bg-white border-green-500 text-green-700 hover:bg-green-50 hover:shadow-md'}
                    `}
                >
                    <span className={`${compact ? 'text-base' : 'text-lg'} font-bold leading-none`}>{room.roomNumber}</span>
                    <span className={`${compact ? 'text-[9px]' : 'text-[10px]'} mt-1 opacity-80 font-medium whitespace-nowrap overflow-hidden`}>
                        {isOccupied ? '已住' : '空闲'}
                    </span>
                    {isOccupied && (
                        <div className="absolute -top-1.5 -right-1.5 bg-red-500 text-white rounded-full p-0.5 shadow-sm">
                            <IconUser size={compact ? 8 : 10} />
                        </div>
                    )}
                </button>
            );
        });

        // 3.2 控制面板组件
        const AllocationPanel = React.memo(({ 
            isMobile, 
            bedType, setBedType, 
            guestCount, setGuestCount, 
            preferLarge, setPreferLarge, 
            onAutoAllocate, 
            onResetAll 
        }) => (
            <div className={`
                bg-white shadow-sm border border-gray-200 p-6 flex flex-col h-full
                ${isMobile ? 'rounded-xl border-none shadow-none p-0 bg-transparent' : 'rounded-none border-0 border-r border-gray-200'}
            `}>
                <h2 className={`text-lg font-semibold mb-4 text-gray-700 flex items-center gap-2 flex-shrink-0 ${isMobile ? '' : 'border-b pb-2'}`}>
                    <IconLogin className="text-blue-500"/> 快速分配入住
                </h2>
                
                <div className={`space-y-6 flex-grow ${!isMobile && 'overflow-y-auto scrollbar-thin'}`}>
                    <div>
                        <label className="block text-sm font-medium text-gray-500 mb-2">选择床型</label>
                        <div className="grid grid-cols-3 gap-3">
                            <button 
                                onClick={() => { setBedType('single'); setGuestCount('single'); }}
                                className={`py-3 px-2 rounded-lg border-2 flex flex-col md:flex-row items-center justify-center gap-2 transition-all text-sm ${bedType === 'single' ? 'border-blue-500 bg-blue-50 text-blue-700 font-bold' : 'bg-white border-gray-200 text-gray-600 hover:border-blue-200'}`}
                            >
                                <IconBed /> 单床
                            </button>
                            <button 
                                onClick={() => setBedType('twin')}
                                className={`py-3 px-2 rounded-lg border-2 flex flex-col md:flex-row items-center justify-center gap-2 transition-all text-sm ${bedType === 'twin' ? 'border-blue-500 bg-blue-50 text-blue-700 font-bold' : 'bg-white border-gray-200 text-gray-600 hover:border-blue-200'}`}
                            >
                                <div className="flex"><IconBed /><IconBed /></div> 双床
                            </button>
                            <button 
                                onClick={() => setBedType('triple')}
                                className={`py-3 px-2 rounded-lg border-2 flex flex-col md:flex-row items-center justify-center gap-2 transition-all text-sm ${bedType === 'triple' ? 'border-blue-500 bg-blue-50 text-blue-700 font-bold' : 'bg-white border-gray-200 text-gray-600 hover:border-blue-200'}`}
                            >
                                <div className="flex -space-x-1"><IconBed /><IconBed /><IconBed /></div> 三床
                            </button>
                        </div>
                    </div>

                    {bedType === 'single' && (
                        <div className="animate-fade-in bg-white/50 md:bg-gray-50 p-4 rounded-lg border border-gray-100">
                            <label className="block text-sm font-medium text-gray-500 mb-2">入住人数</label>
                            <div className="flex gap-4 mb-4">
                                <label className="flex items-center gap-2 cursor-pointer">
                                    <input type="radio" name={`guestCount_${isMobile?'m':'d'}`} checked={guestCount === 'single'} onChange={() => setGuestCount('single')} className="w-5 h-5 text-blue-600"/>
                                    <span className="flex items-center gap-1 text-sm"><IconUser size={16}/> 单人</span>
                                </label>
                                <label className="flex items-center gap-2 cursor-pointer">
                                    <input type="radio" name={`guestCount_${isMobile?'m':'d'}`} checked={guestCount === 'multi'} onChange={() => setGuestCount('multi')} className="w-5 h-5 text-blue-600"/>
                                    <span className="flex items-center gap-1 text-sm"><IconUsers size={16}/> 多人</span>
                                </label>
                            </div>

                            {guestCount === 'single' && (
                                <div className="pt-2 border-t border-gray-200 mt-2">
                                    <label className="flex items-center gap-2 cursor-pointer select-none">
                                        <input type="checkbox" checked={preferLarge} onChange={(e) => setPreferLarge(e.target.checked)} className="w-5 h-5 text-blue-600 rounded" />
                                        <span className="text-gray-700 text-sm pl-2">偏好大床</span>
                                    </label>
                                </div>
                            )}
                        </div>
                    )}

                    <button 
                        onClick={onAutoAllocate}
                        className="w-full py-4 bg-blue-600 hover:bg-blue-700 active:bg-blue-800 text-white text-lg font-bold rounded-xl shadow-lg shadow-blue-200 transition-colors flex items-center justify-center gap-2"
                    >
                        <IconCheck /> 自动分配
                    </button>
                </div>

                {!isMobile && (
                    <div className="mt-auto pt-6 border-t border-gray-200 text-center">
                        <button 
                            onClick={onResetAll}
                            className="text-gray-400 hover:text-red-500 text-sm flex items-center justify-center gap-1 mx-auto transition-colors"
                        >
                            <IconTrash /> 清空所有数据
                        </button>
                    </div>
                )}
            </div>
        ));

        // 3.3 房型内容组件
        const RoomTypeContent = React.memo(({ typeConfig, isCompactGrid, allRooms, searchTerm, onToggleRoom }) => {
            // 数据处理逻辑
            const data = useMemo(() => {
                // 1. 过滤当前房型 + 搜索
                let roomsOfType = allRooms.filter(r => r.typeId === typeConfig.id);
                if (searchTerm && searchTerm.trim()) {
                    roomsOfType = roomsOfType.filter(r => r.roomNumber.includes(searchTerm.trim()));
                }

                if (roomsOfType.length === 0) return null;

                // 2. 按楼层分组
                const floorsData = {};
                roomsOfType.forEach(room => {
                    const floorKey = room.roomNumber.charAt(0);
                    if (!floorsData[floorKey]) floorsData[floorKey] = [];
                    floorsData[floorKey].push(room);
                });

                // 3. 排序楼层
                const sortedFloorKeys = Object.keys(floorsData).sort((a, b) => b - a);

                return { floorsData, sortedFloorKeys };
            }, [allRooms, searchTerm, typeConfig.id]);
            
            if (!data) return (
                <div className="h-full flex items-center justify-center text-gray-300 text-sm">
                    {searchTerm ? '无匹配房间' : '暂无数据'}
                </div>
            );

            return (
                <div className={`${isCompactGrid ? 'space-y-2' : 'space-y-3'}`}>
                    {data.sortedFloorKeys.map(floor => (
                        <div key={floor} className="mb-2 last:mb-0">
                            {/* 楼层线 */}
                            <div className="flex items-center gap-2 mb-1.5">
                                <span className="text-[10px] font-bold text-slate-500 bg-slate-200 px-1.5 py-0.5 rounded">{floor}层</span>
                                <div className="h-px bg-slate-200 flex-grow"></div>
                            </div>
                            {/* 房间Grid */}
                            <div className={`grid gap-2 ${isCompactGrid ? 'grid-cols-4 lg:grid-cols-5' : 'grid-cols-4 sm:grid-cols-6'}`}>
                                {data.floorsData[floor].map(room => (
                                    <RoomCard 
                                        key={room.roomNumber} 
                                        room={room} 
                                        compact={isCompactGrid}
                                        onToggle={() => onToggleRoom(room.roomNumber, !room.isOccupied)}
                                    />
                                ))}
                            </div>
                        </div>
                    ))}
                </div>
            );
        });

        // --- 4. 主应用程序 ---
        function HotelManager() {
            // 状态管理
            const [allRooms, setAllRooms] = useState([]);
            const [bedType, setBedType] = useState('single'); 
            const [guestCount, setGuestCount] = useState('single');
            const [preferLarge, setPreferLarge] = useState(false);
            const [message, setMessage] = useState(null); 
            const [searchTerm, setSearchTerm] = useState('');
            // 新增：记录每个模块缩放比例的状态 { [typeId]: scaleValue }
            const [zoomLevels, setZoomLevels] = useState({});

            // 初始化
            useEffect(() => {
                const savedData = localStorage.getItem('hotel_rooms_data_v1');
                if (savedData) {
                    setAllRooms(JSON.parse(savedData));
                } else {
                    const initialRooms = [];
                    INITIAL_CONFIG.forEach(type => {
                        type.rooms.forEach(roomNum => {
                            initialRooms.push({
                                roomNumber: roomNum.toString(),
                                typeId: type.id,
                                typeName: type.name,
                                isOccupied: false,
                                checkInTime: null
                            });
                        });
                    });
                    setAllRooms(initialRooms);
                }
            }, []);

            // 保存
            useEffect(() => {
                if (allRooms.length > 0) {
                    localStorage.setItem('hotel_rooms_data_v1', JSON.stringify(allRooms));
                }
            }, [allRooms]);

            const showMessage = (text, type = 'success') => {
                setMessage({ text, type });
                setTimeout(() => setMessage(null), 3000);
            };

            const handleAutoAllocate = useCallback(() => {
                let targetTypeIds = [];
                if (bedType === 'twin') {
                    targetTypeIds = ['twin_1.2'];
                } else if (bedType === 'triple') {
                    targetTypeIds = ['triple_1.0'];
                } else if (bedType === 'single') {
                    if (guestCount === 'multi') {
                        targetTypeIds = ['std_double_1.5', 'large_double_1.8'];
                    } else {
                        if (preferLarge) {
                            targetTypeIds = ['narrow_double_1.5', 'std_double_1.5', 'large_double_1.8'];
                        } else {
                            targetTypeIds = ['small_single_1.2', 'narrow_double_1.5', 'std_double_1.5', 'large_double_1.8'];
                        }
                    }
                }

                let foundRoom = null;
                const currentRooms = allRooms; 
                for (const typeId of targetTypeIds) {
                    const availableRooms = currentRooms.filter(r => r.typeId === typeId && !r.isOccupied);
                    if (availableRooms.length > 0) {
                        foundRoom = availableRooms[0];
                        break;
                    }
                }

                if (foundRoom) {
                    updateRoomStatus(foundRoom.roomNumber, true);
                    showMessage(`分配成功！房间号：${foundRoom.roomNumber} (${foundRoom.typeName})`);
                } else {
                    showMessage('没有符合条件的空闲房间了！', 'error');
                }
            }, [allRooms, bedType, guestCount, preferLarge]);

            const updateRoomStatus = useCallback((roomNumber, isOccupied) => {
                setAllRooms(prevRooms => prevRooms.map(room => {
                    if (room.roomNumber === roomNumber) {
                        return {
                            ...room,
                            isOccupied: isOccupied,
                            checkInTime: isOccupied ? new Date().toLocaleString() : null
                        };
                    }
                    return room;
                }));
            }, []);

            const handleResetAll = useCallback(() => {
                if (window.confirm('确定要清空所有入住状态吗？此操作不可恢复。')) {
                    setAllRooms(prevRooms => prevRooms.map(r => ({ ...r, isOccupied: false, checkInTime: null })));
                    showMessage('系统已重置，所有房间为空闲状态。');
                }
            }, []);

            // 新增：处理缩放
            const handleZoom = (typeId, delta) => {
                setZoomLevels(prev => {
                    const currentZoom = prev[typeId] || 1;
                    // 限制缩放范围 0.5 (50%) 到 1.5 (150%)
                    const newZoom = Math.max(0.5, Math.min(1.5, currentZoom + delta));
                    return { ...prev, [typeId]: newZoom };
                });
            };

            const stats = useMemo(() => ({
                total: allRooms.length,
                occupied: allRooms.filter(r => r.isOccupied).length,
                free: allRooms.filter(r => !r.isOccupied).length
            }), [allRooms]);

            const allocationProps = {
                bedType, setBedType,
                guestCount, setGuestCount,
                preferLarge, setPreferLarge,
                onAutoAllocate: handleAutoAllocate,
                onResetAll: handleResetAll
            };

            return (
                <div className="h-screen flex flex-col bg-slate-50">
                    {/* 顶部标题栏 */}
                    <div className="bg-blue-600 text-white p-4 shadow-md z-30 flex-shrink-0">
                        <div className="max-w-full mx-auto flex justify-between items-center px-2 md:px-6">
                            <h1 className="text-xl font-bold flex items-center gap-2">
                                <IconHome /> 房间分配系统3.6
                            </h1>
                            <div className="text-sm bg-blue-700 px-3 py-1 rounded-full whitespace-nowrap">
                                空闲: {stats.free} / 总房: {stats.total}
                            </div>
                        </div>
                    </div>

                    {/* 消息提示 */}
                    {message && (
                        <div className={`fixed top-20 left-1/2 transform -translate-x-1/2 px-6 py-3 rounded-lg shadow-lg text-white font-medium animate-bounce z-50 ${message.type === 'error' ? 'bg-red-500' : 'bg-green-600'}`}>
                            {message.text}
                        </div>
                    )}

                    {/* 主内容区域 */}
                    <div className="flex-1 flex flex-col md:flex-row md:overflow-hidden relative overflow-hidden">
                        
                        {/* ================= 电脑端布局 (左侧面板 + 右侧列表) ================= */}
                        
                        {/* 电脑端：左侧模块 (仅在电脑端显示) */}
                        <div className="hidden md:block md:w-80 md:flex-shrink-0 md:h-full border-r border-gray-200 z-20 bg-white">
                             <AllocationPanel isMobile={false} {...allocationProps} />
                        </div>

                        {/* 电脑端：右侧模块 (仅在电脑端显示) */}
                        <div className="hidden md:flex flex-1 flex-col md:bg-slate-50 md:h-full overflow-hidden">
                            {/* 电脑端：搜索栏 */}
                            <div className="flex items-center justify-between p-4 bg-white border-b border-gray-200 shadow-sm z-10">
                                <h2 className="text-lg font-semibold text-gray-700 flex items-center gap-2">
                                    <IconHome size={20} className="text-orange-500"/> 房态总览
                                </h2>
                                <div className="flex items-center gap-4">
                                    <div className="relative w-64">
                                        <div className="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"><IconSearch className="text-gray-400" /></div>
                                        <input 
                                            type="text" 
                                            placeholder="搜索房间号..." 
                                            value={searchTerm}
                                            onChange={(e) => setSearchTerm(e.target.value)}
                                            className="w-full pl-10 pr-8 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none text-sm"
                                        />
                                        {searchTerm && <button onClick={() => setSearchTerm('')} className="absolute inset-y-0 right-0 pr-3 text-gray-400 hover:text-gray-600">×</button>}
                                    </div>
                                    <div className="flex gap-3 text-xs whitespace-nowrap">
                                        <div className="flex items-center gap-1"><div className="w-2.5 h-2.5 bg-green-500 rounded"></div>空</div>
                                        <div className="flex items-center gap-1"><div className="w-2.5 h-2.5 bg-red-500 rounded"></div>住</div>
                                    </div>
                                </div>
                            </div>

                            {/* 电脑端：核心网格 (已添加单独缩放功能) */}
                            <div className="grid grid-cols-3 grid-rows-2 gap-3 p-3 flex-1 min-h-0 overflow-hidden">
                                {INITIAL_CONFIG.map(type => {
                                    const currentZoom = zoomLevels[type.id] || 1;
                                    return (
                                        <div key={type.id} className="bg-white rounded-lg border border-gray-200 shadow-sm flex flex-col overflow-hidden">
                                            <div className="px-3 py-2 bg-gray-50 border-b border-gray-100 flex items-center flex-shrink-0">
                                                <div className="flex items-baseline gap-2 flex-grow min-w-0">
                                                    <h3 className="font-bold text-gray-700 text-sm border-l-4 border-blue-500 pl-2 leading-none whitespace-nowrap">{type.name}</h3>
                                                    <span className="text-[10px] text-gray-400 truncate">{type.desc}</span>
                                                </div>
                                                {/* 缩放控件 */}
                                                <div className="flex items-center gap-1 ml-1 bg-white rounded border border-gray-200 px-1">
                                                    <button onClick={() => handleZoom(type.id, -0.1)} className="text-gray-500 hover:text-blue-600 p-0.5" title="缩小">
                                                        <IconMinus size={12}/>
                                                    </button>
                                                    <span className="text-[10px] text-gray-600 w-8 text-center select-none">{Math.round(currentZoom * 100)}%</span>
                                                    <button onClick={() => handleZoom(type.id, 0.1)} className="text-gray-500 hover:text-blue-600 p-0.5" title="放大">
                                                        <IconPlus size={12}/>
                                                    </button>
                                                </div>
                                            </div>
                                            <div className="p-2 overflow-y-auto scrollbar-thin flex-1 bg-slate-50/30 relative">
                                                {/* 缩放容器：
                                                    transform: 缩放
                                                    transformOrigin: 从左上角缩放
                                                    width: 必须反向调整宽度，否则缩小时右侧会有大量空白，放大时会溢出
                                                */}
                                                <div style={{ 
                                                    transform: `scale(${currentZoom})`, 
                                                    transformOrigin: 'top left',
                                                    width: `${100 / currentZoom}%`
                                                }}>
                                                    <RoomTypeContent 
                                                        typeConfig={type} 
                                                        isCompactGrid={true} 
                                                        allRooms={allRooms}
                                                        searchTerm={searchTerm}
                                                        onToggleRoom={updateRoomStatus}
                                                    />
                                                </div>
                                            </div>
                                        </div>
                                    );
                                })}
                            </div>
                        </div>

                        {/* ================= 移动端布局 (上下统一滚动) ================= */}
                        
                        <div className="md:hidden flex-1 overflow-y-auto no-scrollbar bg-slate-50 pb-20">
                            {/* 移动端容器：包含分配模块和房态列表，统一在一个滚动流中 */}
                            <div className="p-4 space-y-4">
                                
                                {/* 1. 分配模块 (内嵌) */}
                                <div className="bg-white rounded-xl shadow-sm border border-gray-200 p-4">
                                     <AllocationPanel isMobile={true} {...allocationProps} />
                                </div>

                                {/* 2. 房态总览模块 (内嵌) */}
                                <div className="bg-white rounded-xl shadow-sm border border-gray-200 p-4">
                                    <div className="flex flex-col gap-4 border-b border-gray-100 pb-4 mb-4">
                                        <div className="flex justify-between items-center">
                                            <h2 className="text-lg font-semibold text-gray-700 flex items-center gap-2">
                                                <IconHome size={20} className="text-orange-500"/> 房态总览
                                            </h2>
                                            <div className="flex gap-3 text-xs whitespace-nowrap">
                                                <div className="flex items-center gap-1"><div className="w-2.5 h-2.5 bg-green-500 rounded"></div>空</div>
                                                <div className="flex items-center gap-1"><div className="w-2.5 h-2.5 bg-red-500 rounded"></div>住</div>
                                            </div>
                                        </div>
                                        <div className="relative w-full">
                                            <div className="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"><IconSearch className="text-gray-400" /></div>
                                            <input 
                                                type="text" 
                                                placeholder="搜索房间号..." 
                                                value={searchTerm}
                                                onChange={(e) => setSearchTerm(e.target.value)}
                                                className="w-full pl-10 pr-8 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none text-sm"
                                            />
                                            {searchTerm && <button onClick={() => setSearchTerm('')} className="absolute inset-y-0 right-0 pr-3 text-gray-400 hover:text-gray-600">×</button>}
                                        </div>
                                    </div>

                                    <div className="space-y-6">
                                        {INITIAL_CONFIG.map(type => (
                                            <div key={type.id} className="animate-fade-in">
                                                <div className="flex items-baseline gap-2 mb-2">
                                                    <h3 className="font-bold text-gray-800 text-base border-l-4 border-blue-500 pl-2 leading-none">{type.name}</h3>
                                                    <span className="text-xs text-gray-400">{type.desc}</span>
                                                </div>
                                                <div className="bg-slate-50/80 rounded-lg p-2 border border-slate-100">
                                                    <RoomTypeContent 
                                                        typeConfig={type} 
                                                        isCompactGrid={false} 
                                                        allRooms={allRooms}
                                                        searchTerm={searchTerm}
                                                        onToggleRoom={updateRoomStatus}
                                                    />
                                                </div>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                                
                                <div className="text-center pt-2">
                                    <button 
                                        onClick={handleResetAll}
                                        className="text-gray-400 hover:text-red-500 text-sm flex items-center justify-center gap-1 mx-auto transition-colors p-2"
                                    >
                                        <IconTrash /> 清空所有入住数据 (重置)
                                    </button>
                                    <p className="text-xs text-gray-300">数据自动保存在本机浏览器中</p>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<HotelManager />);
    </script>
</body>
</html>

